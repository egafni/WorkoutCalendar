# from wtforms_alchemy import ModelForm
# from .. import Workout
#
#
# class EventForm(ModelForm):
# class Meta:
# model = Workout
# field_args = {
# }
#
# exclude = ['created_on']
from wtforms import StringField, TextAreaField
from wtforms.ext.sqlalchemy.fields import QuerySelectField
from wtforms import validators
from wtforms import Form

from ..app import session
from ..models import Movement





# def get_time():
# timenow = datetime.datetime.now().replace(second=0, microsecond=0).time()
# return datetime.datetime.combine(dateutil.parser.parse(start), timenow)

def get_movement_query():
    return session.query(Movement)


DEFAULT_IMG = '<img height="50" src="data:image/jpeg;base64,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" >'


def get_movement_label(movement):
    img = '<img src="%s" height="50">' % movement.thumbnail if movement.thumbnail else DEFAULT_IMG
    return '{img} {m.name}'.format(m=movement, **locals())


class WorkoutForm(Form):
    start = StringField('start', validators=[validators.DataRequired()])
    name = StringField('name', validators=[validators.DataRequired()])
    notes = TextAreaField('notes')


class MovementForm(Form):
    name = StringField('name', validators=[validators.DataRequired()])
    category = StringField('tempo')
    thumbnail = StringField('thumbnail')
    description = TextAreaField('description')


class WorkForm(Form):
    movement = QuerySelectField('movement', query_factory=get_movement_query, get_label=get_movement_label, allow_blank=True,
                                blank_text='<div style="clear: both"><span style="">%s</span> Choose a Movement</div>' % DEFAULT_IMG)
    tempo = StringField('tempo')
    amount = TextAreaField('amount')
